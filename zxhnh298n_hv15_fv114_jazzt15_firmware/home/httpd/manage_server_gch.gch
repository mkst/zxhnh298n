<%IMPORT FILE "common_gch.gch";var FP_OBJNAME = "OBJ_MANAGESERVER_ID";var FP_MULTIDISPLAY = 0;var FP_IDENTITY = "";var FP_PARANUM = 17;var FP_ERRORSTR = "SUCC";var FP_HANDLE;var PARA[17] ={"URL","UserName","UserPassword","PeriodicInformEnable","PeriodicInformInterval","ParameterKey","ConnectionRequestURL","ConnectionRequestUsername","ConnectionRequestPassword","UpgradesManaged","DefaultWan","SupportCertAuth","ConnectionRequestPort","Tr069Enable","MWSURL","CertID","CertList"};var MASK_PARA[17] ={NULL,NULL,"******",NULL,NULL,NULL,NULL,NULL,"******",NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL};var FP_PAGE = request("IF_PAGE");if (FP_PAGE IS NULL){FP_PAGE = "";}var FP_ACTION = request("IF_ACTION");create_form_start("fSubmit", "");createSubmitHidden(FP_MULTIDISPLAY, PARA, FP_PARANUM, "");if (FP_ACTION == "apply"){FP_HANDLE = create_paralist();for(var i=0; i< FP_PARANUM; i++){setpara(FP_HANDLE, PARA[i]);}if("NotTr069"== FP_PAGE){set_para(FP_HANDLE, "UserPassword", strdecode(request("UserPassword")));set_para(FP_HANDLE, "ConnectionRequestPassword", strdecode(request("ConnectionRequestPassword")));}FP_IDENTITY = set_inst(FP_HANDLE, FP_OBJNAME, FP_IDENTITY);}if (FP_MULTIDISPLAY == 0){FP_HANDLE = create_paralist();get_inst(FP_HANDLE, FP_OBJNAME, FP_IDENTITY);var UserPsd = get_para(FP_HANDLE, "UserPassword");set_para(FP_HANDLE, "UserPassword", strencode(UserPsd));var ConReqPsd = get_para(FP_HANDLE, "ConnectionRequestPassword");set_para(FP_HANDLE, "ConnectionRequestPassword", strencode(ConReqPsd));filter_cover_hidden(FP_HANDLE, PARA, MASK_PARA, FP_PARANUM);destroy_paralist(FP_HANDLE);}getDisplayInstError(FP_ERRORSTR);create_hidden_sep("IF_PAGE", "");create_form_end();%>