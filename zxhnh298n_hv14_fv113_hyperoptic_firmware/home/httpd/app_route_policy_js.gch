<script language="javascript">var PROUTE_PARA = new Array("DestInterface","Dscp","SrcIP","DestIP","SrcIPMask","DestIPMask","SrcPort","DestPort","Protocol","SrcMAC");var PARA = new Array("UserPriority","SrcInterface");var index ="";var IPv6Ctr = "<%=encodeJS(getenv("DevIPv6Effect"));%>";function getmsg(id){var str = new Array();str[0] = new Array(122, "&?error_122;");str[1] = new Array(118, "&?error_118;");str[2] = new Array(127, "&?error_127;");str[3] = new Array(108, "&?error_108;");str[4] = new Array(101, "&?error_101;");str[5] = new Array(115, "&?error_115;");str[6] = new Array(116, "&?error_116;");str[7] = new Array(117, "&?error_117;");str[8] = new Array(109, "&?error_109;");str[9] = new Array(110, "&?error_110;");str[10] = new Array(142, "&?error_142;");return getMsgFormArray(str, arguments);}function pageLoad(url){getObj("fSubmit").action = url;var msg = "";var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");OldProcessRet(errstr, errpara);moveErrLayer(580,40);showTable();}function getImage(src, strmethod, id){return ("<input type=\"button\" id=\""+id+"\"  onclick=\""+ strmethod +"\" style=\"width:20px;height:20px;border:0px;padding:2px;cursor:pointer;background:url("+src+");\">");}function getNameValue(id, size, value){return ("<input type=\"text\" class=\"uiNoBorder\" size=\"" + size +"\" value=\""
+ HTMLEnCode(value) + "\"  id=\"" + id + "\"  readonly>");}function showTable(){var num = getValue("IF_INSTNUM");if( num > 0){for(var i = 0; i < num; i++){var obj=getObj("Frm_DestInterface");var len = obj.length;var flag = 0; for(var j =0; j<len; j++){if(getValue(PROUTE_PARA[0]+i) == obj.options[j].value){flag = 1;}}if(flag == 0 && IPv6Ctr == 0) continue;addline(i);}var obj=getObj("Frm_DestInterface");var len = obj.length;var k = 0; if(IPv6Ctr == 0){for(var i = 0; i < num; i++){var flag = 0;for(var j =0; j<len; j++){if(getValue(PROUTE_PARA[0]+i) == obj.options[j].value){flag = 1;}}if(flag == 0){k+=1; }}if(num == k){var newline = getObj("proute_Table").insertRow(-1);newline.setAttribute("align", "center");newline.setAttribute("class", "white");newline.setAttribute("className", "white");var objcell = newline.insertCell(-1);objcell.colSpan = 6;objcell.innerHTML= "&?note_007;";}}}else {var newline = getObj("proute_Table").insertRow(-1);newline.setAttribute("align", "center");newline.setAttribute("class", "white");newline.setAttribute("className", "white");var objcell = newline.insertCell(-1);objcell.colSpan = 6;objcell.innerHTML= "&?note_007;";}}function addline(index){var newline = getObj("proute_Table").insertRow(-1);var newline2 = getObj("proute_Table").insertRow(-1);var cellId = "";var cellSize = 10;var cellValue = "";newline.setAttribute("class", "white");newline.setAttribute("className", "white");for(var i = 0; i < PROUTE_PARA.length ; i+=2){cellId = "Line_"+ index + "_"+ PROUTE_PARA[i] + "_"+ i;if(PROUTE_PARA[i]=="DestInterface"&&getValue(PROUTE_PARA[0]+index)!=""){jslSetValue("Frm_DestInterface",PROUTE_PARA[0]+index);var obj=getObj("Frm_DestInterface");cellValue=obj.options[obj.selectedIndex].text;newline.insertCell(-1).innerHTML = getNameValue(cellId, cellSize, "");}else {cellValue = getValue(PROUTE_PARA[i]+index);if(cellValue=="0.0.0.0"||cellValue=="00:00:00:00:00:00"){cellValue="";}else if(cellValue=="0"&&PROUTE_PARA[i]=="SrcPort"){cellValue="";}newline.insertCell(-1).innerHTML = getNameValue(cellId, cellSize, "");}setValue(cellId, cellValue);}newCell = newline.insertCell(-1);newCell.innerHTML = getImage("img/button_delete.gif", "pageDel("+index+")", "delete"+ index);newCell.id = "delete_"+ (2*index).toString();newline2.setAttribute("class", "white");newline2.setAttribute("className", "white");for(var i = 1; i < PROUTE_PARA.length ; i+=2){cellId = "Line_"+ index + "_"+ PROUTE_PARA[i] + "_"+ i;cellValue = getValue(PROUTE_PARA[i]+index);if(cellValue=="0.0.0.0"||cellValue=="00:00:00:00:00:00"){cellValue="";}else if(cellValue=="0"&&PROUTE_PARA[i]=="DestPort"){cellValue="";}else if(cellValue=="-1"&&PROUTE_PARA[i]=="Dscp"){cellValue="";}newline2.insertCell(-1).innerHTML = getNameValue(cellId, cellSize, "");setValue(cellId, cellValue);}newCell = newline2.insertCell(-1);newCell.id = "delete_"+ (2*index+1).toString();var obj0 = document.getElementById("delete_"+ (2*index).toString());var obj1 = document.getElementById("delete_"+ (2*index+1).toString());obj0.rowSpan++;obj1.parentNode.removeChild(obj1);}function MacSetValue(){var value = getValue("mac1");value += ":"+ getValue("mac2");value += ":"+ getValue("mac3");value += ":"+ getValue("mac4");value += ":"+ getValue("mac5");value += ":"+ getValue("mac6");if( ":::::"== value){value = "";}return value;}function pageSetValue(){HiddenParaInit(PROUTE_PARA);HiddenParaInit(PARA);jslSetValue("DestInterface", "Frm_DestInterface");if(getValue("Frm_Dscp")=="")setValue("Dscp","-1");else jslSetValue("Dscp", "Frm_Dscp");if(getValue("Frm_SrcIP")=="")setValue("SrcIP","0.0.0.0");else jslSetValue("SrcIP", "Frm_SrcIP");if(getValue("Frm_DestIP")=="")setValue("DestIP","0.0.0.0");else jslSetValue("DestIP", "Frm_DestIP");if(getValue("Frm_SrcIPMask")=="")setValue("SrcIPMask","0.0.0.0");else jslSetValue("SrcIPMask", "Frm_SrcIPMask");if(getValue("Frm_DestIPMask")=="")setValue("DestIPMask","0.0.0.0");else jslSetValue("DestIPMask", "Frm_DestIPMask");jslSetValue("Protocol", "Frm_Protocol");if(getValue("Frm_SrcPort")=="")setValue("SrcPort","0");else jslSetValue("SrcPort", "Frm_SrcPort");if(getValue("Frm_DestPort")=="")setValue("DestPort","0");else jslSetValue("DestPort", "Frm_DestPort");var value = MacSetValue();if(value=="")setValue("SrcMAC", "00:00:00:00:00:00");else setValue("SrcMAC", value);}function Check_IntegerRange(value,min,max,Frm,Fnt){var tem = checkIntegerRange(value,min,max);if(tem==-2){msg = getmsg(115);ShowErrorForCom(Frm,Fnt,msg);return false;}else if(tem==-3){msg = getmsg(116,min,max);ShowErrorForCom(Frm,Fnt,msg);return false;}return true;}function pageCheckValue(insId){var msg = "";var Dscp=getValue("Frm_Dscp");if(Check_IntegerRange(Dscp,0,63,"Frm_Dscp","Fnt_Dscp")!=true){return false;}var SrcIP=getValue("Frm_SrcIP");if(SrcIP!=""){if(checkIpAddress(SrcIP,"")!=true||SrcIP=="0.0.0.0"){msg = getmsg(108);ShowErrorForCom("Frm_SrcIP","Fnt_SrcIP",msg);return false;}}var DestIP=getValue("Frm_DestIP");if(DestIP!=""){if(checkIpAddress(DestIP,"")!=true||DestIP=="0.0.0.0"){msg = getmsg(108);ShowErrorForCom("Frm_DestIP","Fnt_DestIP",msg);return false;}}var SrcIPMask=getValue("Frm_SrcIPMask");if(SrcIPMask!=""){if(checkMaskAddress(SrcIPMask)!=true||SrcIPMask=="0.0.0.0"){msg = getmsg(109);ShowErrorForCom("Frm_SrcIPMask","Fnt_SrcIPMask",msg);return false;}}var DestIPMask=getValue("Frm_DestIPMask");if(DestIPMask!=""){if(checkMaskAddress(DestIPMask)!=true||DestIPMask=="0.0.0.0"){msg = getmsg(109);ShowErrorForCom("Frm_DestIPMask","Fnt_DestIPMask",msg);return false;}}var protocol = getValue("Frm_Protocol");var SrcPort=getValue("Frm_SrcPort");if(Check_IntegerRange(SrcPort,1,65535,"Frm_SrcPort","Fnt_SrcPort")!=true){return false;}else if( SrcPort != ""&& protocol != "TCP"&& protocol != "UDP"){msg = getmsg(142);ShowErrorForCom("Frm_SrcPort","",msg);return false;}var DestPort=getValue("Frm_DestPort");if(Check_IntegerRange(DestPort,1,65535,"Frm_DestPort","Fnt_DestPort")!=true){return false;}else if( DestPort != ""&& protocol != "TCP"&& protocol != "UDP"){msg = getmsg(142);ShowErrorForCom("Frm_DestPort","",msg);return false;}var value = MacSetValue();if(value!=""){if(checkMACAddress(value)!=true||value=="00:00:00:00:00:00"){msg = getmsg(110);ShowErrorForCom("mac1","Fnt_SrcMAC",msg);return false;}}return true;}function modifyGetValue(i){jslSetValue("Frm_DestInterface", "DestInterface"+i);jslSetValue("Frm_Dscp", "Dscp"+i);jslSetValue("Frm_SrcIP", "SrcIP"+i);jslSetValue("Frm_DestIP", "DestIP"+i);jslSetValue("Frm_SrcIPMask", "SrcIPMask"+i);jslSetValue("Frm_DestIPMask", "DestIPMask"+i);jslSetValue("Frm_Protocol", "Protocol"+i);jslSetValue("Frm_SrcPort", "SrcPort"+i);jslSetValue("Frm_DestPort", "DestPort"+i);jslSetValue("Frm_SrcMAC", "SrcMAC"+i);}function disableAllButton(){jslDisable("Btn_Add");var num = getValue("IF_INSTNUM");for( var btn_i = 0; btn_i < num; btn_i++){var obj=getObj("Frm_DestInterface");var len = obj.length;var flag = 0; for(var j =0; j<len; j++){if(getValue(PROUTE_PARA[0]+btn_i) == obj.options[j].value){flag = 1;}}if(flag == 0 && IPv6Ctr == 0) continue;jslDisable("delete"+ btn_i);}}function pageAdd(){ReSetIpRmZero("Frm_SrcIP","Frm_SrcIPMask","Frm_DestIP","Frm_DestIPMask");ReSetValueRmZero("Frm_SrcPort","Frm_DestPort","Frm_Dscp");if(true == pageCheckValue(-1)){disableAllButton();pageSetValue();setValue("IF_ACTION", "new");setValue("IF_INDEX", "-1");DisableALL();getObj("fSubmit").submit();}else {}}function pageDel(i){disableAllButton();setValue("IF_ACTION", "delete");setValue("IF_INDEX",i);DisableALL();getObj("fSubmit").submit();}</script>