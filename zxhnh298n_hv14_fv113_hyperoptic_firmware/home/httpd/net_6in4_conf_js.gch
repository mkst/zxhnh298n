<script language="javascript">var PARA = new Array("Tunl64ViewName","MTU","Tunl64type","6rdtype","REMOTEIPAddr","6rdprefix","6rdprefixLen","IPv4MaskLen","6rdBRIPv4Addr","Tunl64Aliasname","WANCID","ConnStatus");function getmsg(id){var str = new Array();str[0] = new Array(128, "&?error_128;");str[1] = new Array(101, "&?error_101;");str[2] = new Array(102, "&?error_102;");str[3] = new Array(103, "&?error_103;");str[4] = new Array(114, "&?error_114;");str[5] = new Array(108, "&?error_108;");str[6] = new Array(208, "&?error_208;");str[7] = new Array(200, "&?error_200;");str[8] = new Array(210, "&?error_210;");str[9] = new Array(215, "&?error_215;");str[10] = new Array(115, "&?error_115;");str[11] = new Array(116, "&?error_116;");str[12] = new Array(117, "&?error_117;");return getMsgFormArray(str, arguments);}function pageLoad(url){getObj("fSubmit").action = url;var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");OldProcessRet(errstr, errpara);moveErrLayer(590,110);pageGetValue();}function getBrowser(){var oType = "";if(navigator.userAgent.indexOf("MSIE")!=-1){oType="IE";}else if(navigator.userAgent.indexOf("Firefox")!=-1){oType="FIREFOX";}return oType;}function GetWanname(oper,browser){var wannameobj = getObj("Frm_WANName");var wan_namenum = getValue("WAN_NUM");var localwanname = getValue("WANCID");var k = 0;var flag = 0;if(oper == "-1"){for(var i=0; i< wan_namenum; i++){var identity = getValue("IF_WANIDENTITY"+i);var WANNAME = getValue("IF_WANNAME"+i);wannameobj.options[i] = new Option(WANNAME,identity);}}else {for(var i=0; i< wan_namenum; i++){var identity = getValue("IF_WANIDENTITY"+i);var WANNAME = getValue("IF_WANNAME"+i);if(localwanname == identity ){flag = 1; }}if(flag == 0 && "FIREFOX"== browser){k = 1;wannameobj.options[0] = new Option("","-2");}for(var i=0; i< wan_namenum; i++){var identity = getValue("IF_WANIDENTITY"+i);var WANNAME = getValue("IF_WANNAME"+i);wannameobj.options[k] = new Option(WANNAME,identity);k++;}}}function pageGetValue(){var t6in4nameobj = getObj("Frm_6in4Name");var t6in4namenum = getValue("IF_INSTNUM");t6in4nameobj.options[0] = new Option("&?tunnel010;","-1");for(var i=0; i< t6in4namenum; i++){var t6in4identity = getValue("IF_6IN4IDENTITY"+i);var t6in4name = getValue("IF_6IN4NAME"+i);t6in4nameobj.options[i+1] = new Option(t6in4name,t6in4identity);}var Browser=getBrowser();var key = getValue("IF_IDENTITY");if (key == ""){key = -1;}GetWanname(key,Browser);if(key == "-1"){jslEnDisplay("Btn_Add","Btn_Cancel");jslDiDisplay("Btn_DoEdit","Btn_Delete");setValue("Frm_6in4Name","-1");setValue("Frm_MTU","1380");setValue("Frm_64Type","manual");Change_64Type();} else {jslDiDisplay("Btn_Add","Btn_Cancel");jslEnDisplay("Btn_DoEdit","Btn_Delete");jslSetValue("Frm_6in4Name","IF_IDENTITY");if ( ""!= getValue("Frm_6in4Name") && "-1"!= getValue("Frm_6in4Name")){var obj=getObj("Frm_6in4Name");var name=obj.options[obj.selectedIndex].text;setValue("Frm_New6in4Name",name);}jslSetValue("Frm_WANName","WANCID");jslSetValue("Frm_MTU","MTU");var Type6in4 = getValue("Tunl64type");jslSetValue("Frm_64Type","Tunl64type");if("manual"== Type6in4){jslEnDisplay("TABLE_ManualTun");jslDiDisplay("TABLE_6rdTun");jslSetValue("Frm_RemoteAddrT64","REMOTEIPAddr");}else if("6rd"== Type6in4){jslEnDisplay("TABLE_6rdTun");jslDiDisplay("TABLE_ManualTun");var Type6rd = getValue("6rdtype");jslSetValue("Frm_Configuration","6rdtype");Change_Configuration();if("Static"== Type6rd){jslSetValue("Frm_6rdPrefix","6rdprefix");jslSetValue("Frm_6rdPrefixLen","6rdprefixLen");jslSetValue("Frm_6rdMask","IPv4MaskLen");jslSetValue("Frm_6rdBrAddress","6rdBRIPv4Addr");}}jslDisable("Frm_WANName");}}function Change_64Type(){var TypeValue = getValue("Frm_64Type");if(TypeValue == "manual"){jslDiDisplay("TABLE_6rdTun");jslEnDisplay("TABLE_ManualTun");}else if(TypeValue == "6rd"){jslDiDisplay("TABLE_ManualTun");jslEnDisplay("TABLE_6rdTun");var LocalConfig = getValue("6rdtype");if(""==LocalConfig ||"NULL"== LocalConfig){setValue("Frm_Configuration","Static");}else {setValue("Frm_Configuration",LocalConfig);}Change_Configuration();}}function Change_Configuration(){var ConfigValue = getValue("Frm_Configuration");jslEnDisplay("TABLE_6rdTun");jslDiDisplay("TABLE_ManualTun");if(ConfigValue == "Static"){jslEnDisplay("TR_6rdPrefix","TR_6rdMask","TR_6rdBrAddress");}else if(ConfigValue == "Auto"){jslDiDisplay("TR_6rdPrefix","TR_6rdMask","TR_6rdBrAddress");}}function Change_Link(){var link=getValue("Frm_6in4Name");if(link=="-1"){setValue("IF_ACTION","NULL");setValue("IF_IDENTITY", "-1");DisableALL();getObj("fSubmit").submit();}else {setValue("IF_ACTION","Reposition");setValue("IF_IDENTITY", link);DisableALL();getObj("fSubmit").submit();;}}function Check_StrLengthRange(value,min,max,Frm,Fnt){if (value.length < min || value.length > max){msg = getmsg(102,min,max);ShowErrorForCom(Frm,Fnt,msg);return false;}return true;}function CheckIPv6(value,Frm, Fnt){if (""==value){msg = getmsg(101);ShowErrorForCom(Frm,Fnt,msg);return false;}if ("::"==value||false==checkIPV6Address(value)){msg = getmsg(200);ShowErrorForCom(Frm,Fnt,msg);return false;}return true;}function pageCheckValue(){var msg="";var newname = getValue("Frm_New6in4Name");var obj=getObj("Frm_6in4Name");var name0=obj.options[obj.selectedIndex].text;var tun_namenum = getValue("IF_INSTNUM");for(var i=0; i< tun_namenum; i++){var TUNNAME = getValue("IF_6IN4NAME"+i);if(newname==TUNNAME&&newname!=name0) {msg = getmsg(128);ShowErrorForCom("Frm_New6in4Name","Fnt_New6in4Name",msg);return false;}}var wannum = getValue("WAN_INSTNUM");for(var i=0; i< wannum; i++){var wanname = getValue("IF_NAME"+i);if(wanname == newname ){msg = getmsg(215);ShowErrorForCom("Frm_New6in4Name","Fnt_New6in4Name",msg);return false;}}var dslitenum = getValue("DSLITE_INSTNUM");for(var i=0; i< dslitenum; i++){var dslitname = getValue("DSLITENAME"+i);if(dslitname == newname){msg = getmsg(215);ShowErrorForCom("Frm_New6in4Name","Fnt_New6in4Name",msg);return false;}}if(Check_StrLengthRange(newname,1,32,"Frm_New6in4Name","Fnt_New6in4Name")!=true){return false;}if(checkGenString(newname)!=true){msg = getmsg(114);ShowErrorForCom("Frm_New6in4Name","Fnt_New6in4Name",msg);return false;}var wan_value = getValue("Frm_WANName");if(Check(wan_value,"Frm_WANName","Fnt_WANName")!=true){return false;}var MTU = getValue("Frm_MTU");if(Check_IntegerRange(MTU,1280,16364,"Frm_MTU","Fnt_MTU")!=true){return false;}var Type6in4 = getValue("Frm_64Type");if("manual"== Type6in4){var RemoteAddr = getValue("Frm_RemoteAddrT64");if (""== RemoteAddr){msg = getmsg(101);ShowErrorForCom("Frm_RemoteAddrT64","Fnt_RemoteAddrT64",msg);return false;}else if (checkIpAddress(RemoteAddr,"")!=true){msg = getmsg(108);ShowErrorForCom("Frm_RemoteAddrT64","Fnt_RemoteAddrT64",msg);return false;}else if (RemoteAddr=="0.0.0.0"){msg = getmsg(108);ShowErrorForCom("Frm_RemoteAddrT64","Fnt_RemoteAddrT64",msg);return false;}}else if("6rd"== Type6in4){var Type6rd = getValue("Frm_Configuration");if("Static"== Type6rd){if (CheckIPv6(getValue("Frm_6rdPrefix"),"Frm_6rdPrefix", "Fnt_6rdPrefix")!=true){return false;}if (Check_IntegerRange(getValue("Frm_6rdPrefixLen"),1,96,"Frm_6rdPrefixLen","&?ipv6_wan012;")!=true){return false;}if (Check_IntegerRange(getValue("Frm_6rdMask"),0,32,"Frm_6rdMask","Fnt_6rdMask")!=true){return false;}var BrAddress = getValue("Frm_6rdBrAddress");if(""== BrAddress){msg = getmsg(101);ShowErrorForCom("Frm_6rdBrAddress","Fnt_6rdBrAddress",msg);return false;}else if (checkIpAddress(BrAddress,"")!=true){msg = getmsg(108);ShowErrorForCom("Frm_6rdBrAddress","Fnt_6rdBrAddress",msg);return false;}else if (BrAddress=="0.0.0.0"){msg = getmsg(108);ShowErrorForCom("Frm_6rdBrAddress","Fnt_6rdBrAddress",msg);return false;}}}return true;}function Check_IntegerRange(value,min,max,Frm,Fnt){var tem = checkIntegerRange(value,min,max);if(tem==-1){msg = getmsg(101);ShowErrorForCom(Frm,Fnt,msg);return false;}else if(tem==-2){msg = getmsg(115);ShowErrorForCom(Frm,Fnt,msg);return false;}else if(tem==-3){msg = getmsg(116,min,max);ShowErrorForCom(Frm,Fnt,msg);return false;}return true;}function Check(value,Frm,Fnt){if(value==""){msg = getmsg(101);ShowErrorForCom(Frm,Fnt,msg);return false;}return true;}function pageSetValue(){var Name6in4 = getValue("Frm_6in4Name");if (Name6in4 == -1){setValue("IF_IDENTITY","-1");}else {jslSetValue("IF_IDENTITY","Frm_6in4Name");}jslSetValue("Tunl64Aliasname","Frm_New6in4Name");jslSetValue("WANCID","Frm_WANName");jslSetValue("MTU","Frm_MTU");var Type6in4 = getValue("Frm_64Type");jslSetValue("Tunl64type","Frm_64Type");if("manual"== Type6in4){jslSetValue("REMOTEIPAddr","Frm_RemoteAddrT64");setValue("6rdtype","Static");setValue("6rdprefix","::");setValue("6rdprefixLen","0");setValue("IPv4MaskLen","0");setValue("6rdBRIPv4Addr","0.0.0.0");}else if("6rd"== Type6in4){jslSetValue("6rdtype","Frm_Configuration");setValue("REMOTEIPAddr","0.0.0.0");var Type6rd = getValue("Frm_Configuration");if("Static"== Type6rd){jslSetValue("6rdprefix","Frm_6rdPrefix");jslSetValue("6rdprefixLen","Frm_6rdPrefixLen");jslSetValue("IPv4MaskLen","Frm_6rdMask");jslSetValue("6rdBRIPv4Addr","Frm_6rdBrAddress");}else if("Auto"== Type6rd){setValue("6rdprefix","::");setValue("6rdprefixLen","0");setValue("IPv4MaskLen","0");setValue("6rdBRIPv4Addr","0.0.0.0");}}setValue("ConnStatus","0");}function pageAdd(){ReSetIpRmZero("Frm_RemoteAddrT64","Frm_6rdPrefix","Frm_6rdBrAddress");if(pageCheckValue()==true){jslDisable("Btn_Add","Btn_DoEdit","Btn_Delete","Btn_Cancel");pageSetValue();setValue("IF_ACTION","new");DisableALL();getObj("fSubmit").submit();}}function pageCancel(){jslDisable("Btn_Add","Btn_DoEdit","Btn_Delete","Btn_Cancel");DisableALL();document.getElementById("fSubmit").submit();}function pageEdit(){ReSetIpRmZero("Frm_RemoteAddrT64","Frm_6rdPrefix","Frm_6rdBrAddress");if(pageCheckValue()==true){DisableALL();pageSetValue();setValue("IF_ACTION","edit");getObj("fSubmit").submit();}}function pageDel(){DisableALL();setValue("IF_ACTION","delete");getObj("fSubmit").submit();}</script>