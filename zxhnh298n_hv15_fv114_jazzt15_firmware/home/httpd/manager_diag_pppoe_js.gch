<script language="javascript">function getmsg(id){var str = new Array();str[0] = new Array(101, "&?error_101;");return getMsgFormArray(str, arguments) }function myDiagStart(){var instnum = getValue("IF_INSTNUM");if (instnum < 1){getObj("Fnt_Msg").innerHTML = "&?diag008;";return;}var identity = getValue("Frm_Interface");if (identity == ""){msg = getmsg(101);ShowErrorForCom("Frm_Interface", "Fnt_Interface", msg);return;}setValue("IF_ACTION", "set");setValue("IF_IDENTITY", identity);setValue("IF_TIMER", "20");setValue("IF_DIAGSTART", "1");getObj("Fnt_Msg").innerHTML = "&?diag002;";jslDisable("Diagnose", "Frm_Interface");DisableALL();getObj("fSubmit").submit();}function refresh(){var instnum = getValue("IF_INSTNUM");if (instnum < 1){getObj("Fnt_Msg").innerHTML = "&?diag008;";return;}DisableALL();getObj("fSubmit").submit();}function UpdateResult(id){var val = getValue("IF_"+id);if(val == "pass"){document.getElementById(id).setAttribute("class", "green");document.getElementById(id).setAttribute("className", "green");}else if(val == "fail"){document.getElementById(id).setAttribute("class", "red");document.getElementById(id).setAttribute("className", "red");}else {document.getElementById(id).setAttribute("class", "");document.getElementById(id).setAttribute("className", "");}}function pageLoad(url){getObj("fSubmit").action = url;var instnum = getValue("IF_INSTNUM");if (instnum < 1){getObj("Fnt_Msg").innerHTML = "&?diag008;";return;}var identity = getValue("IF_IDENTITY");setValue("Frm_Interface", identity);UpdateResult("DiagServerConnResult");UpdateResult("DiagServerSessionResult");UpdateResult("DiagAuthResult");UpdateResult("DiagIPResult");UpdateResult("DiagDNSResult");UpdateResult("DiagGetwayResult");var tag = getValue("IF_DIAGSTART");if (tag == "1"){setValue("IF_ACTION", "get");var result = getValue("IF_ERRORSTR");if(result == "004"){var time=getValue("IF_TIMER");if(time > 0){getObj("Fnt_Msg").innerHTML = "&?diag002;";setValue("IF_TIMER",time-1);jslDisable("Diagnose", "Frm_Interface");setTimeout("refresh()", 3000);}else {setValue("IF_DIAGSTART", "0");getObj("Fnt_Msg").innerHTML = "&?diagp03;";}}else {setValue("IF_DIAGSTART", "0");getObj("Fnt_Msg").innerHTML = "&?diagp03;";}}}</SCRIPT>