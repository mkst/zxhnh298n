<script language="javascript">var URL_PARA = new Array("ViewName","Enable","Url","FilterTarget","APPId","User");var URL_BASIC_PARA = new Array("ViewName","UserName","UrlEnable","UrlTarget");var index ="";function getmsg(id){var str = new Array();str[0] = new Array(101, "&?error_101;");str[1] = new Array(105, "&?error_105;");str[2] = new Array(118, "&?error_118;");str[3] = new Array(119, "&?error_119;");str[4] = new Array(122, "&?error_122;");str[5] = new Array(127, "&?error_127;");str[6] = new Array(143, "&?error_143;");str[7] = new Array(102, "&?error_102;");str[8] = new Array(103, "&?error_103;");str[9] = new Array(100, "&?error_100;");return getMsgFormArray(str, arguments);}function pageLoad(url){getObj("fSubmit").action = url;var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");OldProcessRet(errstr, errpara);moveErrLayer(570,4);showTable();pageGetValue();}function getImage(src, strmethod,Btn_id){return ("<input type=\"button\" id=\""+Btn_id+"\"  onclick=\""+ strmethod +"\" style=\"width:20px;height:20px;border:0px;padding:2px;cursor:pointer;background:url("+src+");\">");}function addline(index,user){var newline = getObj("URL_Table").insertRow(-1);newline.setAttribute("class", "white");newline.setAttribute("className", "white");cellId = "Line_"+ index + "_"+ URL_PARA[0] + "_"+ 0;newline.insertCell(-1).innerHTML = getNameValue(cellId,60,getValue("Url"+user+index));newline.insertCell(-1).innerHTML = getImage("img/button_delete.gif","Delete("+index+")","Btn_Delete"+index);}function showTable(){getUserID();var user=getValue("Frm_UserID");if (user!=""){jslEnDisplay("URL_Table");var UserNum = getValue("INSTNUM_URL"+user);if(UserNum != 0 ){for(var i = 0; i < UserNum; i++){addline(i,user);}}else {var newline = getObj("URL_Table").insertRow(-1);newline.setAttribute("align", "center");newline.setAttribute("class", "white");newline.setAttribute("className", "white");var objcell = newline.insertCell(-1);objcell.colSpan = 2;objcell.innerHTML= "&?note_007;";}}else {jslDiDisplay("URL_Table");}}function getNameValue(id, size, value){return ("<input type=\"text\" class=\"uiNoBorder\" size=\""
+ size
+"\" value=\""
+ HTMLEnCode(value)
+ "\"  id=\""
+ id
+ "\"  readonly>");}function Add(){if(pageCheckValue() == true){var user=getValue("Frm_UserID");var number = getValue("INSTNUM_URL"+user);document.getElementById("add").style.display="";document.getElementById("modify").style.display="none";for(var i = 0; i < number; i++){jslDisable("Btn_Delete"+ i);}jslDisable("add");pageSetValue();setValue("IF_ACTION_URL", "new");setValue("IF_ACTION_USER", "none");setValue("IF_INDEX_URL", -1);setValue("IF_INDEX_USER",UserIndex());jslDisable("Frm_Mode","Frm_Enable");getObj("fSubmit").submit();}else {}}function getUserID(){var UserIDobj=getObj("Frm_UserID");var UserNum=getValue("INSTNUM_USER");if (UserNum>0){for(var i = 0; i < UserNum; i++){var UserID=getValue("UserID"+i);if (UserID=="all"){UserIDobj.options[i] = new Option("&?cpcturl016;",UserID);}else {UserIDobj.options[i] = new Option(UserID,UserID);}}}if (getValue("IF_INDEX_USER")!=""){UserIDobj.selectedIndex = getValue("IF_INDEX_USER");}}function pageCheckValue(){if(false == CheckURL(getValue("Frm_URL"))){return false;}if(false == pageCheckUser()){return false;}return true;}function pageCheckUser(){if(false == getValue("Frm_UserID")){msg = getmsg(100);ShowErrorForCom( "Frm_UserID","Fnt_UserID", msg);return false;}return true;}function pageSetValue(){HiddenParaInit(URL_PARA);jslSetValue("Url", "Frm_URL");jslSetValue("User", "Frm_UserID");}function pageGetValue(){var i=UserIndex();if (i!=-1){jslPostToViewCheckBox( "Frm_Enable","UrlEnable"+i);if (getValue("UrlTarget"+i)!=""){jslSetValue( "Frm_Mode","UrlTarget"+i);}else {setValue( "Frm_Mode",0);}}else {jslPostToViewCheckBox( "Frm_Enable","UrlEnable");if (getValue("UrlTarget")!=""){jslSetValue( "Frm_Mode","UrlTarget");}else {setValue( "Frm_Mode",0);}}}function Delete(i){HiddenParaInit(URL_PARA);var UserID=getValue("Frm_UserID");setValue("User",UserID);setValue("IF_ACTION_URL", "delete");setValue("IF_ACTION_USER", "none");setValue("IF_INDEX_USER",UserIndex());setValue("IF_INDEX_URL",UrlIndex(i));jslDisable("Frm_Mode","Frm_Enable");jslDisable("add");var number = getValue("INSTNUM_URL"+UserID);for(var i = 0; i < number; i++){jslDisable("Btn_Delete"+ i);}getObj("fSubmit").submit();}function UserIndex(){var UserID=getValue("Frm_UserID");var ind =-1;for(var i=0; i < getObj("Frm_UserID").length; i++){if(getObj("Frm_UserID").options[i].value == UserID){ind=i;break;}}return ind;}function UrlIndex(j){var UserID=getValue("Frm_UserID");var index=-1;for(var i=0; i < getValue("IF_INSTNUM"); i++){if(getValue("Url"+UserID+j)== getValue("Url"+i)){if ( UserID == getValue("User"+i) ){index=i;break;}else {continue;}}}return index;}function Slect_Enable(){if (false!=pageCheckUser()){HiddenParaInit(URL_BASIC_PARA);var UserID=getValue("Frm_UserID");jslSetValue("UserName", "Frm_UserID");jslViewToPostCheckBox("UrlEnable", "Frm_Enable");jslSetValue("UrlTarget", "Frm_Mode");setValue("IF_ACTION_USER", "apply");setValue("IF_ACTION_URL", "none");setValue("IF_INDEX_USER",UserIndex());jslDisable("Frm_Mode","Frm_Enable","add");var number = getValue("INSTNUM_URL"+UserID);for(var i = 0; i < number; i++){jslDisable("Btn_Delete"+ i);}getObj("fSubmit").submit();}else {}}function Slect_Mode(){if (false!=pageCheckUser()){HiddenParaInit(URL_BASIC_PARA);var UserID=getValue("Frm_UserID");jslSetValue("UserName", "Frm_UserID");jslViewToPostCheckBox("UrlEnable", "Frm_Enable");jslSetValue("UrlTarget", "Frm_Mode");setValue("IF_INDEX_USER",UserIndex());setValue("IF_ACTION_USER", "apply");setValue("IF_ACTION_URL", "none");jslDisable("Frm_Mode","Frm_Enable","add");var number = getValue("INSTNUM_URL"+UserID);for(var i = 0; i < number; i++){jslDisable("Btn_Delete"+ i);}getObj("fSubmit").submit();}else {}}function CheckURL(url){var statu = checkStrLengthRange(url, 1, 128);if(statu==-1){msg = getmsg(101);ShowErrorForCom( "Frm_URL","Fnt_URL", msg);return false;}if(statu == -3){msg = getmsg(102,1,128);ShowErrorForCom( "Frm_URL","Fnt_URL", msg);return false;}if (url.match("[^0-9a-zA-Z.:;,!@%#?_/&=+*'$()-]") != null){msg = getmsg(105);ShowErrorForCom( "Frm_URL","Fnt_URL", msg);return false;}return true;}function Slect_User(){setValue("IF_ACTION_USER", "none");setValue("IF_ACTION_URL", "none");setValue("IF_INDEX_USER",UserIndex());jslDisable("Frm_Mode","Frm_Enable","add");getObj("fSubmit").submit();}</script>