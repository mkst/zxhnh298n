<%IMPORT FILE "common_gch.gch";var FP_OBJNAME = "OBJ_FWPMAPP_ID";var FP_PARANUM = 6;var FP_ERRORSTR = "SUCC";var FP_INDEX = getInstIndex("new");var FP_MULTIDISPLAY = 1;var FP_INSTNUM;var FP_HANDLE;var PARA[6] ={"ViewName","WANCViewName","WANCName","APPName","Enable","InternalHost"};var FP_APPName = request("IF_APPName");if (FP_APPName IS NULL){FP_APPName = "";}var FP_WANCViewName = request("IF_WANCViewName");if (FP_WANCViewName IS NULL){FP_WANCViewName = "";}var FP_InternalHost = request("IF_InternalHost");if (FP_InternalHost IS NULL){FP_InternalHost = "";}var FP_ACTION = request("IF_ACTION");create_form_start("fSubmit", "");createSubmitHidden(FP_MULTIDISPLAY, PARA, FP_PARANUM, FP_INDEX);create_hidden_sep("IF_APPName", FP_APPName);create_hidden_sep("IF_WANCViewName", FP_WANCViewName);create_hidden_sep("IF_InternalHost", FP_InternalHost);create_form_end();var FP_IDENTITY = getInstIdentityByAction(FP_OBJNAME, FP_MULTIDISPLAY, FP_ACTION, FP_INDEX);FP_ERRORSTR = getDisplayInstError(FP_ERRORSTR);FP_ERRORSTR = applyOrNewInst(FP_OBJNAME, FP_ACTION, FP_IDENTITY, PARA, FP_PARANUM, FP_ERRORSTR);if (FP_ACTION == "delete"){FP_INSTNUM = query_list(FP_OBJNAME, "IGD");for (var i = 0; i < FP_INSTNUM; i++){FP_HANDLE = create_paralist();FP_IDENTITY = query_identity(i);get_inst(FP_HANDLE, FP_OBJNAME, FP_IDENTITY);if(get_para(FP_HANDLE, "APPName") == FP_APPName&& get_para(FP_HANDLE, "WANCViewName") == FP_WANCViewName&& get_para(FP_HANDLE, "InternalHost") == FP_InternalHost){del_inst(FP_OBJNAME, FP_IDENTITY);}destroy_paralist(FP_HANDLE);}}FP_INSTNUM = query_list(FP_OBJNAME, "IGD");if (FP_MULTIDISPLAY == 1){for (var i=0; i<FP_INSTNUM; i++){var FP_HANDLE = create_paralist();FP_IDENTITY = query_identity(i);get_inst(FP_HANDLE, FP_OBJNAME, FP_IDENTITY);create_hidden_multiinstpara(FP_HANDLE, PARA, i, FP_PARANUM);var FP_INCViewName = get_para(FP_HANDLE, "WANCViewName");destroy_paralist(FP_HANDLE);var WancId = getenv("ObjWancId");query_list(WancId, "IGD");var WAN_HANDLE = create_paralist();set_hidden("WANCName"+i, identity2name(FP_INCViewName));destroy_paralist(WAN_HANDLE);query_list(FP_OBJNAME, "IGD");}}getDisplayInstError(FP_ERRORSTR);set_hidden("IF_INSTNUM", FP_INSTNUM);%>