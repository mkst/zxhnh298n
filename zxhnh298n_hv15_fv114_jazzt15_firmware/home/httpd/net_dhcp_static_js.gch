<script language="javascript">var DHCPS_PARA = new Array("ViewName","HostCfgViewName","IPAddr","MACAddr");var DHCPSTATIC_PARA = new Array("IPAddr","MACAddr");var index ="";function getmsg(id){var str = new Array();str[0] = new Array(101, "&?error_101;");str[1] = new Array(108, "&?error_108;");str[2] = new Array(110, "&?error_110;");str[3] = new Array(118, "&?error_118;");str[4] = new Array(119, "&?error_119;");str[5] = new Array(122, "&?error_122;");str[6] = new Array(141, "&?error_141;");str[7] = new Array(127, "&?error_127;");str[8] = new Array(142, "&?error_142;");return getMsgFormArray(str, arguments)}function pageLoad(url){getObj("fSubmit").action = url;var errstr= getValue("IF_ERRORSTR");var errpara = getValue("IF_ERRORPARAM");OldProcessRet(errstr, errpara);moveErrLayer(592,20);showTable();}function getImage(src, strmethod,id){return ("<input type=\"button\" id=\""+id+"\"  onclick=\""+ strmethod +"\" style=\"width:20px;height:20px;border:0px;padding:2px;cursor:pointer;background:url("+src+");\">");}function addline(index){var newline = getObj("Dhcp_Table").insertRow(-1);newline.setAttribute("class", "white");newline.setAttribute("className", "white");for(var i = 0; i < DHCPSTATIC_PARA.length ; i++){if( getValue(DHCPSTATIC_PARA[i]+index) == "00:00:00:00:00:00"){setValue(DHCPSTATIC_PARA[i]+index,"");}newline.insertCell(-1).innerHTML = getValue(DHCPSTATIC_PARA[i]+index);}newline.insertCell(-1).innerHTML=getImage("img/button_modify.gif", "Modify("+index+")", "Btn_Modify"+index);newline.insertCell(-1).innerHTML=getImage("img/button_delete.gif", "Delete("+index+")", "Btn_Delete"+index);}function showTable(){var num = getValue("IF_INSTNUM");if(num != 0 ){for(var i = 0; i < num; i++){addline(i);}}else {var newline = getObj("Dhcp_Table").insertRow(-1);newline.setAttribute("align", "center");newline.setAttribute("class", "white");newline.setAttribute("className", "white");var objcell = newline.insertCell(-1);objcell.colSpan = 4;objcell.innerHTML= "&?note_007;"}}function MacGetValue(i){var value = getValue("MACAddr"+i);if (value == ""){setValue("mac1", "");setValue("mac2", "");setValue("mac3", "");setValue("mac4", "");setValue("mac5", "");setValue("mac6", "");}else {var temp= value.split(":");setValue("mac1", temp[0]);setValue("mac2", temp[1]);setValue("mac3", temp[2]);setValue("mac4", temp[3]);setValue("mac5", temp[4]);setValue("mac6", temp[5]);}}function MacSetValue(){var value = getValue("mac1");value += ":"+ getValue("mac2");value += ":"+ getValue("mac3");value += ":"+ getValue("mac4");value += ":"+ getValue("mac5");value += ":"+ getValue("mac6");if( ":::::"== value){value = "";}return value;}function ModifyGetValue(i){jslSetValue("Frm_IPAddr", "IPAddr"+i);MacGetValue(i);}function pageSetValue(){HiddenParaInit(DHCPS_PARA);jslSetValue("IPAddr", "Frm_IPAddr");var value = MacSetValue();if(value!="")setValue("MACAddr", value);else setValue("MACAddr", "00:00:00:00:00:00");}function pageCheckValue(){var msg = "";var value = MacSetValue();if(checkNull(getValue("Frm_IPAddr")) != true){msg = getmsg(101);ShowErrorForCom("Frm_IPAddr","Fnt_IPAddr",msg);return false;}if(checkIpAddress(getValue("Frm_IPAddr")) != true){msg = getmsg(108);ShowErrorForCom("Frm_IPAddr","Fnt_IPAddr",msg);return false;}if(value == "00:00:00:00:00:00"){msg = getmsg(110);ShowErrorForCom("mac1","Fnt_MACAddr",msg);return false;}if((checkMACAddress(value) != true)&&(value !="")){msg = getmsg(110);ShowErrorForCom("mac1","Fnt_MACAddr",msg);return false;}if ( value.toLowerCase() == "ff:ff:ff:ff:ff:ff"){msg = getmsg(110);ShowErrorForCom("mac1","Fnt_MACAddr",msg);return false;}return true;}function Add(){var number = getValue("IF_INSTNUM");document.getElementById("add").style.display="";document.getElementById("modify").style.display="none";ReSetIpRmZero("Frm_IPAddr");if(pageCheckValue() == true){for(var i = 0; i < number; i++){jslDisable("Btn_Delete"+ i,"Btn_Modify"+ i);}jslDisable("add","modify");pageSetValue();setValue("IF_ACTION", "new");setValue("IF_INDEX", "-1");DisableALL();getObj("fSubmit").submit();}else {}}function Modify(i){document.getElementById("add").style.display="none";document.getElementById("modify").style.display="";document.getElementById("back").style.display="";ModifyGetValue(i);index=i;}function ModifySubmit(){var number = getValue("IF_INSTNUM");ReSetIpRmZero("Frm_IPAddr");if(pageCheckValue() == true){for(var i = 0; i < number; i++){jslDisable("Btn_Delete"+ i,"Btn_Modify"+ i);}jslDisable("add","modify", "back");pageSetValue();setValue("IF_ACTION", "apply");setValue("IF_INDEX",index);DisableALL();getObj("fSubmit").submit();}else {}}function toNext(obj){}function Delete(i){var number = getValue("IF_INSTNUM");setValue("IF_ACTION", "delete");setValue("IF_INDEX",i);jslDisable("add","modify", "back");for(var i = 0; i < number; i++){jslDisable("Btn_Delete"+ i,"Btn_Modify"+ i);}DisableALL();getObj("fSubmit").submit();}function back4add(){var number = getValue("IF_INSTNUM");jslDisable("add","modify", "back");for(var i = 0; i < number; i++){jslDisable("Btn_Modify"+ i);jslDisable("Btn_Delete"+ i);}DisableALL();getObj("fSubmit").submit();}</script>