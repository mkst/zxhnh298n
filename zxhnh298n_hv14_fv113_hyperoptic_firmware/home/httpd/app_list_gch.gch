<%IMPORT FILE "common_gch.gch";var FP_HANDLE, FP_INSTNUM;var FP_OBJNAME = "OBJ_APPLST_ID";var FP_PARANUM = 9;var FP_INDEX = getInstIndex("new");var FP_MULTIDISPLAY = 1;var FP_ACTION = request("IF_ACTION");var FP_ERRORSTR = "SUCC";var PARA[9] ={"ViewName","Enable","APPName","Catalog","Protocol","StartPort","EndPort","StartMapPort","EndMapPort"};var FP_APPName = request("IF_APPName");if (FP_APPName IS NULL){FP_APPName = "";}create_form_start("fSubmit", "");createSubmitHidden(FP_MULTIDISPLAY, PARA, FP_PARANUM, FP_INDEX);var FP_IDENTITY = getInstIdentityByAction(FP_OBJNAME, FP_MULTIDISPLAY, FP_ACTION, FP_INDEX);if (FP_ACTION == "delete"){FP_INSTNUM = query_list(FP_OBJNAME, "IGD");for (var i = 0; i < FP_INSTNUM; i++){FP_HANDLE = create_paralist();FP_IDENTITY = query_identity(i);get_inst(FP_HANDLE, FP_OBJNAME, FP_IDENTITY);if(get_para(FP_HANDLE, "APPName") == FP_APPName){del_inst(FP_OBJNAME, FP_IDENTITY);}destroy_paralist(FP_HANDLE);}}FP_ERRORSTR = getDisplayInstError(FP_ERRORSTR);FP_ERRORSTR = applyOrNewInst(FP_OBJNAME, FP_ACTION, FP_IDENTITY, PARA, FP_PARANUM, FP_ERRORSTR);FP_INSTNUM = displayInst(FP_OBJNAME, FP_MULTIDISPLAY, PARA, FP_PARANUM, FP_ERRORSTR);set_hidden("IF_INSTNUM", FP_INSTNUM);create_hidden_sep("IF_APPName", FP_APPName);create_form_end();%>