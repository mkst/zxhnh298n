<%IMPORT FILE "common_gch.gch";function WANC_TYPE(){var FP_TYPE, WANC_HANDLE, WANC_OBJNAME, WANC_IDENTITY;var FP_INDEX = request("IF_INDEX");var WANC_ACTION = request("IF_ACTION");var WANC_INSTNUM = query_list("OBJ_DSLWANC_ID", "IGD");setenv("wanc_type","N/A");setenv("wanc_name","N/A");setenv("ERROR","N");if( WANC_ACTION=="wanctype"|| WANC_ACTION=="apply"|| WANC_ACTION=="delete"){WANC_HANDLE = create_paralist();var WANC_MODE = query_identity(FP_INDEX);var type=query_wanctype(FP_INDEX);if(type==""){setenv("wanc_name","&?wan002;");setenv("wanc_type","PPPoE");setenv("ERROR","Y");}else {if(type=="pppoe"){get_inst(WANC_HANDLE, "OBJ_DSLWANCPPP_ID", WANC_MODE);var mode=get_para(WANC_HANDLE, "ATMLinkType");if( mode == "PPPoA"){FP_TYPE="PPPoA";}else {FP_TYPE="PPPoE";}}else if(type=="dhcp/static"){get_inst(WANC_HANDLE, "OBJ_DSLWANCIP_ID", WANC_MODE);var mode=get_para(WANC_HANDLE, "Addressingtype");var typeic=get_para(WANC_HANDLE, "ATMLinkType");if(mode=="Static"&&(typeic=="IPoA"||typeic=="CIP")){FP_TYPE=typeic;}else {FP_TYPE=mode;}}else if(type=="bridge"){FP_TYPE="BRIDGE";}else {}setenv("wanc_type",FP_TYPE);}destroy_paralist(WANC_HANDLE);}}%>