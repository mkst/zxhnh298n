<%IMPORT FILE "common_gch.gch";function service_func(FP_ACTION, FP_INDEX, FP_ERRORSTR){var FP_OBJNAME = "OBJ_DDNSSERVICE_ID";var FP_MULTIDISPLAY = 1;var FP_PARANUM = 7;var FP_INSTNUM = 1;var PARA[7] ={"Name","Server","ServerPort","Request","UpdateInterval","RetryInterval","MaxRetries"};query_list("OBJ_DDNSCLIENT_ID", "IGD");var HANDLE = create_paralist();var IDENTITY = query_identity(0);get_inst(HANDLE, "OBJ_DDNSCLIENT_ID", IDENTITY);var Service = get_para(HANDLE,"Service");destroy_paralist(HANDLE);if (FP_INDEX IS NULL){var DDNS_INSTNUM = query_list("OBJ_DDNSSERVICE_ID", "IGD");for(var i=0; i<DDNS_INSTNUM; i++){var DDNS_HANDLE = create_paralist();var DDNS_IDENTITY = query_identity(i);get_inst(DDNS_HANDLE, "OBJ_DDNSSERVICE_ID", DDNS_IDENTITY);var Name = get_para(DDNS_HANDLE, "Name");if(Name == Service){FP_INDEX = i;}destroy_paralist(DDNS_HANDLE);}if(FP_INDEX IS NULL)FP_INDEX = 0;}create_hidden_newpara(PARA, FP_PARANUM);var FP_IDENTITY = getInstIdentityByAction(FP_OBJNAME, FP_MULTIDISPLAY, FP_ACTION, FP_INDEX);FP_ERRORSTR = getDisplayInstError(FP_ERRORSTR);FP_ERRORSTR = applyOrNewInst(FP_OBJNAME, FP_ACTION, FP_IDENTITY, PARA, FP_PARANUM, FP_ERRORSTR);FP_ERRORSTR = displayFunctionInst(FP_OBJNAME, FP_MULTIDISPLAY, PARA, FP_PARANUM, FP_ERRORSTR);return FP_ERRORSTR;}%>